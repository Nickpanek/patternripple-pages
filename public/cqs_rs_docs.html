<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cqs-rs Browser Simulator - PatternRipple Labs</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        
        header {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
        }
        
        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin: 0.3rem;
        }
        
        .header-buttons {
            margin-top: 1rem;
        }
        
        .header-btn {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            margin: 0.3rem;
            transition: background 0.3s;
            border: 2px solid rgba(255,255,255,0.5);
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .header-btn:hover {
            background: rgba(255,255,255,0.4);
        }
        
        .github-btn {
            background: rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.7);
        }
        
        .github-btn:hover {
            background: rgba(0,0,0,0.5);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .simulator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .panel {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        h2 {
            color: #4a90e2;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        textarea {
            width: 100%;
            min-height: 400px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
            align-items: center;
        }
        
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 500;
        }
        
        button:hover {
            background: #357abd;
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .secondary-btn {
            background: #6c757d;
        }
        
        .secondary-btn:hover {
            background: #5a6268;
        }
        
        label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        input[type="number"] {
            width: 80px;
            padding: 0.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .output {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1.5rem;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            min-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .examples {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            margin-top: 1rem;
        }
        
        .example-btn {
            background: #e9ecef;
            color: #333;
            padding: 0.5rem 1rem;
            margin: 0.3rem;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .example-btn:hover {
            background: #dee2e6;
        }
        
        .info-box {
            background: #e7f3ff;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #4a90e2;
            margin: 1rem 0;
        }
        
        .info-box a {
            color: #357abd;
            font-weight: 600;
        }
        
        .error {
            background: #ffe7e7;
            border-left-color: #dc3545;
            color: #721c24;
        }
        
        .success {
            background: #d4edda;
            border-left-color: #28a745;
            color: #155724;
        }
        
        footer {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
            margin-top: 3rem;
        }
        
        footer a {
            color: #4a90e2;
            text-decoration: none;
        }
        
        @media (max-width: 968px) {
            .simulator-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>üåä cqs-rs Browser Simulator</h1>
        <p>Run quantum circuits right in your browser - no installation needed!</p>
        <div>
            <span class="badge">Browser-Based</span>
            <span class="badge">JavaScript</span>
            <span class="badge">Open Source</span>
        </div>
        <div class="header-buttons">
            <a href="https://github.com/Nickpanek/cqs-rs" class="header-btn github-btn" target="_blank">‚≠ê GitHub Repository</a>
            <button class="header-btn" onclick="downloadFullDocs()">üì• Download Full Documentation</button>
            <a href="https://patternripple.com" class="header-btn">Visit PatternRipple.com</a>
        </div>
        <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.9;">
            By <a href="https://patternripple.com" style="color: white; text-decoration: underline;">PatternRipple.com Labs</a> ‚Ä¢ Created by <a href="https://heylink.me/nickpanek/" style="color: white; text-decoration: underline;" target="_blank">Nick Panek</a>
        </p>
    </header>

    <div class="container">
        <div class="info-box">
            <strong>‚ú® Browser Demo Version!</strong> This is a simplified JavaScript demo of the full cqs-rs simulator (originally written in Rust). 
            It runs entirely in your browser with zero setup - perfect for quick experiments! 
            <br><br>
            <strong>Want the full-featured Rust version?</strong> Visit the <a href="https://github.com/Nickpanek/cqs-rs" target="_blank">GitHub repository</a> for installation instructions. 
            The Rust version includes advanced features like noise models, constraints, deterministic replay, and telemetry logging.
        </div>

        <div class="simulator-grid">
            <div class="panel">
                <h2>üìù Quantum Circuit Program</h2>
                <div class="examples">
                    <strong>Quick Examples:</strong><br>
                    <button class="example-btn" onclick="loadExample('bell')">Bell State</button>
                    <button class="example-btn" onclick="loadExample('superposition')">Superposition</button>
                    <button class="example-btn" onclick="loadExample('ghz')">GHZ State</button>
                    <button class="example-btn" onclick="loadExample('phase')">Phase Flip</button>
                </div>
                <textarea id="program" spellcheck="false">[
  {"op": "init", "n": 2},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "measure", "qubits": [0, 1]}
]</textarea>
                
                <div class="controls">
                    <button onclick="runSimulation()">‚ñ∂Ô∏è Run Simulation</button>
                    <button class="secondary-btn" onclick="clearProgram()">Clear</button>
                    <label>
                        Shots: <input type="number" id="shots" value="100" min="1" max="10000">
                    </label>
                </div>
            </div>

            <div class="panel">
                <h2>üìä Output</h2>
                <div id="output" class="output">Ready to run! Click "Run Simulation" to see results...</div>
            </div>
        </div>

        <div class="panel">
            <h2>üìñ How to Use</h2>
            <ol style="margin-left: 2rem; line-height: 2;">
                <li>Choose an example or write your own JSON circuit program</li>
                <li>Set the number of shots (how many times to run the circuit)</li>
                <li>Click "Run Simulation"</li>
                <li>See the measurement results in the output panel</li>
            </ol>
            <p style="margin-top: 1rem;"><strong>Available operations:</strong> init, h, x, y, z, rx, ry, rz, cnot, cz, measure</p>
            <p style="margin-top: 0.5rem;">For installation and full documentation, visit <a href="https://github.com/Nickpanek/cqs-rs" target="_blank">github.com/Nickpanek/cqs-rs</a></p>
        </div>
    </div>

    <footer>
        <p>Developed by <a href="https://patternripple.com">PatternRipple.com Labs</a> ‚Ä¢ Created by <a href="https://heylink.me/nickpanek/" target="_blank">Nick Panek</a></p>
        <p style="margin-top: 0.5rem;"><a href="https://github.com/Nickpanek/cqs-rs" target="_blank">View on GitHub</a> ‚Ä¢ Open source and free to use</p>
    </footer>

    <script>
        // Simple quantum simulator in JavaScript
        class QuantumState {
            constructor(n) {
                this.n = n;
                this.amplitudes = new Map();
                this.amplitudes.set(0, {re: 1, im: 0});
            }

            getAmplitude(state) {
                return this.amplitudes.get(state) || {re: 0, im: 0};
            }

            setAmplitude(state, amp) {
                if (Math.abs(amp.re) < 1e-10 && Math.abs(amp.im) < 1e-10) {
                    this.amplitudes.delete(state);
                } else {
                    this.amplitudes.set(state, amp);
                }
            }

            getProbability(state) {
                const amp = this.getAmplitude(state);
                return amp.re * amp.re + amp.im * amp.im;
            }

            normalize() {
                let sum = 0;
                for (const amp of this.amplitudes.values()) {
                    sum += amp.re * amp.re + amp.im * amp.im;
                }
                const norm = Math.sqrt(sum);
                if (norm > 0) {
                    for (const [state, amp] of this.amplitudes.entries()) {
                        this.amplitudes.set(state, {re: amp.re / norm, im: amp.im / norm});
                    }
                }
            }
        }

        function complexMul(a, b) {
            return {
                re: a.re * b.re - a.im * b.im,
                im: a.re * b.im + a.im * b.re
            };
        }

        function complexAdd(a, b) {
            return {re: a.re + b.re, im: a.im + b.im};
        }

        function applyH(state, q) {
            const newAmplitudes = new Map();
            const norm = 1 / Math.sqrt(2);
            
            for (const [idx, amp] of state.amplitudes.entries()) {
                const bit = (idx >> q) & 1;
                const flipped = idx ^ (1 << q);
                
                const contrib1 = {re: amp.re * norm, im: amp.im * norm};
                const contrib2 = bit === 0 
                    ? {re: amp.re * norm, im: amp.im * norm}
                    : {re: -amp.re * norm, im: -amp.im * norm};
                
                const curr1 = newAmplitudes.get(idx) || {re: 0, im: 0};
                const curr2 = newAmplitudes.get(flipped) || {re: 0, im: 0};
                
                newAmplitudes.set(idx, complexAdd(curr1, contrib1));
                newAmplitudes.set(flipped, complexAdd(curr2, contrib2));
            }
            
            state.amplitudes = newAmplitudes;
        }

        function applyX(state, q) {
            const newAmplitudes = new Map();
            for (const [idx, amp] of state.amplitudes.entries()) {
                const flipped = idx ^ (1 << q);
                newAmplitudes.set(flipped, amp);
            }
            state.amplitudes = newAmplitudes;
        }

        function applyY(state, q) {
            const newAmplitudes = new Map();
            for (const [idx, amp] of state.amplitudes.entries()) {
                const bit = (idx >> q) & 1;
                const flipped = idx ^ (1 << q);
                const newAmp = bit === 0 
                    ? {re: -amp.im, im: amp.re}
                    : {re: amp.im, im: -amp.re};
                newAmplitudes.set(flipped, newAmp);
            }
            state.amplitudes = newAmplitudes;
        }

        function applyZ(state, q) {
            for (const [idx, amp] of state.amplitudes.entries()) {
                const bit = (idx >> q) & 1;
                if (bit === 1) {
                    state.amplitudes.set(idx, {re: -amp.re, im: -amp.im});
                }
            }
        }

        function applyRZ(state, q, theta) {
            const phase0 = {re: Math.cos(-theta/2), im: Math.sin(-theta/2)};
            const phase1 = {re: Math.cos(theta/2), im: Math.sin(theta/2)};
            
            for (const [idx, amp] of state.amplitudes.entries()) {
                const bit = (idx >> q) & 1;
                const phase = bit === 0 ? phase0 : phase1;
                state.amplitudes.set(idx, complexMul(amp, phase));
            }
        }

        function applyCNOT(state, ctrl, tgt) {
            const newAmplitudes = new Map();
            for (const [idx, amp] of state.amplitudes.entries()) {
                const ctrlBit = (idx >> ctrl) & 1;
                const newIdx = ctrlBit === 1 ? idx ^ (1 << tgt) : idx;
                newAmplitudes.set(newIdx, amp);
            }
            state.amplitudes = newAmplitudes;
        }

        function applyCZ(state, ctrl, tgt) {
            for (const [idx, amp] of state.amplitudes.entries()) {
                const ctrlBit = (idx >> ctrl) & 1;
                const tgtBit = (idx >> tgt) & 1;
                if (ctrlBit === 1 && tgtBit === 1) {
                    state.amplitudes.set(idx, {re: -amp.re, im: -amp.im});
                }
            }
        }

        function measure(state, qubits) {
            const outcomes = 1 << qubits.length;
            const probs = new Array(outcomes).fill(0);
            
            for (const [idx, amp] of state.amplitudes.entries()) {
                let outcome = 0;
                for (let i = 0; i < qubits.length; i++) {
                    const bit = (idx >> qubits[i]) & 1;
                    outcome |= bit << i;
                }
                probs[outcome] += amp.re * amp.re + amp.im * amp.im;
            }
            
            const rand = Math.random();
            let cumProb = 0;
            for (let i = 0; i < outcomes; i++) {
                cumProb += probs[i];
                if (rand <= cumProb) {
                    return i;
                }
            }
            return outcomes - 1;
        }

        function runCircuit(program, shots) {
            const results = [];
            
            for (let shot = 0; shot < shots; shot++) {
                let state = null;
                
                for (const op of program) {
                    if (op.op === 'init') {
                        state = new QuantumState(op.n);
                    } else if (op.op === 'h') {
                        applyH(state, op.q);
                    } else if (op.op === 'x') {
                        applyX(state, op.q);
                    } else if (op.op === 'y') {
                        applyY(state, op.q);
                    } else if (op.op === 'z') {
                        applyZ(state, op.q);
                    } else if (op.op === 'rz') {
                        applyRZ(state, op.q, op.theta);
                    } else if (op.op === 'cnot') {
                        applyCNOT(state, op.ctrl, op.tgt);
                    } else if (op.op === 'cz') {
                        applyCZ(state, op.ctrl, op.tgt);
                    } else if (op.op === 'measure') {
                        const outcome = measure(state, op.qubits);
                        results.push(outcome);
                    }
                }
            }
            
            return results;
        }

        function runSimulation() {
            const programText = document.getElementById('program').value;
            const shots = parseInt(document.getElementById('shots').value);
            const output = document.getElementById('output');
            
            try {
                const program = JSON.parse(programText);
                output.textContent = 'Running simulation...\n\n';
                
                setTimeout(() => {
                    try {
                        const results = runCircuit(program, shots);
                        
                        // Count outcomes
                        const counts = {};
                        for (const result of results) {
                            const bitstring = result.toString(2).padStart(2, '0');
                            counts[bitstring] = (counts[bitstring] || 0) + 1;
                        }
                        
                        let outputText = `‚úÖ Simulation Complete!\n\n`;
                        outputText += `Shots: ${shots}\n`;
                        outputText += `Unique outcomes: ${Object.keys(counts).length}\n\n`;
                        outputText += `Results:\n`;
                        outputText += `${'='.repeat(40)}\n`;
                        
                        const sorted = Object.entries(counts).sort((a, b) => b[1] - a[1]);
                        for (const [bitstring, count] of sorted) {
                            const percent = (count / shots * 100).toFixed(1);
                            const bar = '‚ñà'.repeat(Math.floor(count / shots * 50));
                            outputText += `|${bitstring}‚ü©: ${count.toString().padStart(5)} (${percent}%) ${bar}\n`;
                        }
                        
                        output.textContent = outputText;
                    } catch (err) {
                        output.textContent = `‚ùå Error running simulation:\n${err.message}`;
                    }
                }, 10);
                
            } catch (err) {
                output.textContent = `‚ùå JSON Parse Error:\n${err.message}\n\nPlease check your JSON syntax.`;
            }
        }

        function clearProgram() {
            document.getElementById('program').value = '';
            document.getElementById('output').textContent = 'Ready to run!';
        }

        function loadExample(name) {
            const examples = {
                bell: `[
  {"op": "init", "n": 2},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "measure", "qubits": [0, 1]}
]`,
                superposition: `[
  {"op": "init", "n": 3},
  {"op": "h", "q": 0},
  {"op": "h", "q": 1},
  {"op": "h", "q": 2},
  {"op": "measure", "qubits": [0, 1, 2]}
]`,
                ghz: `[
  {"op": "init", "n": 3},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "cnot", "ctrl": 1, "tgt": 2},
  {"op": "measure", "qubits": [0, 1, 2]}
]`,
                phase: `[
  {"op": "init", "n": 1},
  {"op": "h", "q": 0},
  {"op": "z", "q": 0},
  {"op": "h", "q": 0},
  {"op": "measure", "qubits": [0]}
]`
            };
            
            document.getElementById('program').value = examples[name];
            document.getElementById('output').textContent = 'Program loaded! Click Run to simulate.';
        }

        function downloadFullDocs() {
            const docs = `cqs-rs Full Technical Documentation
========================================

GitHub Repository: https://github.com/Nickpanek/cqs-rs
Documentation: https://www.patternripple.com/cqs_rs_docs.html

Developed by PatternRipple.com Labs
Created by Nick Panek (https://heylink.me/nickpanek/)

================================================================================
INSTALLATION - FULL RUST VERSION
================================================================================

STEP 1: Install Rust
--------------------
Visit: https://rustup.rs/
Or run: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

STEP 2: Clone the Repository
-----------------------------
git clone https://github.com/Nickpanek/cqs-rs.git
cd cqs-rs

STEP 3: Build the Project
--------------------------
cargo build --release

STEP 4: Run Your First Simulation
----------------------------------
Create a test circuit (bell_state.json):
[
  {"op": "init", "n": 2},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "measure", "qubits": [0, 1]}
]

Run it:
./target/release/cqs run --program bell_state.json --shots 100

================================================================================
FEATURES (FULL RUST VERSION)
================================================================================

‚úì All quantum gates (H, X, Y, Z, RX, RY, RZ, CNOT, CZ)
‚úì Noise models (dephasing, depolarizing, amplitude damping)
‚úì Constraint modes (Hamming weight, parity)
‚úì Deterministic replay with BLAKE3 seeding
‚úì Detailed JSONL telemetry logging
‚úì Sparse state pruning with epsilon thresholds
‚úì Postselection support
‚úì Command-line interface
‚úì Cross-validation with Qiskit
‚úì Built-in benchmarking tools

================================================================================
EXAMPLE CIRCUITS
================================================================================

Bell State (Entanglement):
[
  {"op": "init", "n": 2},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "measure", "qubits": [0, 1]}
]

GHZ State (3-way entanglement):
[
  {"op": "init", "n": 3},
  {"op": "h", "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "cnot", "ctrl": 1, "tgt": 2},
  {"op": "measure", "qubits": [0, 1, 2]}
]

Deterministic Simulation with Seed:
[
  {
    "op": "init",
    "n": 3,
    "seed_hex": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
  },
  {"op": "h", "q": 0},
  {"op": "measure", "qubits": [0, 1, 2]}
]

Noise Simulation:
[
  {"op": "init", "n": 2},
  {"op": "h", "q": 0},
  {"op": "noise", "kind": {"kind": "dephasing", "p": 0.01}, "q": 0},
  {"op": "cnot", "ctrl": 0, "tgt": 1},
  {"op": "measure", "qubits": [0, 1]}
]

================================================================================
COMMAND-LINE USAGE
================================================================================

Run a circuit:
  cqs run --program circuit.json --shots 100

With telemetry logging:
  cqs run --program circuit.json --shots 10 --log output

Run benchmarks:
  cargo run --release --bin cqs_bench

Run tests:
  cargo test

================================================================================
ADVANCED FEATURES
================================================================================

Sparse Pruning:
  {"op": "init", "n": 10, "eps2": 1e-12}

Hamming Weight Constraint:
  {"op": "init", "n": 4, "constraint": {"kind": "hamming", "k": 2}}

Parity Constraint:
  {"op": "init", "n": 4, "constraint": {"kind": "parity", "even": true}}

Postselection:
  {"op": "postselect", "qubits": [0, 1], "bits": "01"}

Cross-validate with Qiskit:
  python3 scripts/crossval_qiskit.py circuit.json

================================================================================
SUPPORTED GATES
================================================================================

Single-Qubit Gates:
- H (Hadamard): {"op": "h", "q": 0}
- X (NOT): {"op": "x", "q": 0}
- Y: {"op": "y", "q": 0}
- Z: {"op": "z", "q": 0}
- RX: {"op": "rx", "q": 0, "theta": 1.57}
- RY: {"op": "ry", "q": 0, "theta": 0.785}
- RZ: {"op": "rz", "q": 0, "theta": 3.14}

Two-Qubit Gates:
- CNOT: {"op": "cnot", "ctrl": 0, "tgt": 1}
- CZ: {"op": "cz", "ctrl": 0, "tgt": 1}

Measurement:
- {"op": "measure", "qubits": [0, 1]}

Noise:
- Dephasing: {"op": "noise", "kind": {"kind": "dephasing", "p": 0.01}, "q": 0}
- Depolarizing: {"op": "noise", "kind": {"kind": "depolarizing", "p": 0.01}, "q": 0}
- Amplitude Damping: {"op": "noise", "kind": {"kind": "amplitude_damping", "gamma": 0.05}, "q": 0}

================================================================================
RESOURCES
================================================================================

GitHub: https://github.com/Nickpanek/cqs-rs
Documentation: https://www.patternripple.com/cqs_rs_docs.html
Website: https://patternripple.com
Creator: https://heylink.me/nickpanek/

For issues or questions, visit the GitHub repository.

================================================================================
LICENSE
================================================================================

Open Source - MIT License
See LICENSE file in the repository for details.

================================================================================
END OF DOCUMENTATION
================================================================================`;

            const blob = new Blob([docs], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'cqs-rs-documentation.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
