<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNG2SVG - Convert PNG to Vector SVG for Fabric Printing | PatternRipple</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free PNG to SVG converter tool for fabric designs. Convert 1024x1024px PNG patterns to vector graphics for professional fabric printing. Browser-based, no upload to servers.">
    <meta name="keywords" content="png to svg, vector converter, fabric design tool, pattern vectorization, vtracer, wasm converter, image tracing, vector graphics, fabric printing prep, textile design converter">
    <meta name="author" content="Nick Panek">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.patternripple.com/png2svg.html">

    <!-- AEO Optimization -->
    <meta name="answer" content="A free browser-based tool to convert PNG patterns to SVG vector graphics for professional fabric printing. Optimized for 1024x1024px designs, works entirely client-side with no server uploads.">
    <meta property="article:tag" content="Vector Conversion">
    <meta property="article:tag" content="Fabric Design">
    <meta property="article:tag" content="Pattern Design">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.patternripple.com/png2svg.html">
    <meta property="og:title" content="PNG2SVG - Convert PNG to Vector SVG for Fabric Printing">
    <meta property="og:description" content="Convert your fabric design PNGs to vector SVG format. Browser-based, private, optimized for professional fabric printing.">
    <meta property="og:site_name" content="PatternRipple">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.patternripple.com/png2svg.html">
    <meta name="twitter:title" content="PNG2SVG - Convert PNG to Vector SVG for Fabric Printing">
    <meta name="twitter:description" content="Convert your fabric design PNGs to vector SVG format. Browser-based, private, optimized for professional fabric printing.">

    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "PNG2SVG Converter",
      "description": "Browser-based PNG to SVG vector converter for fabric designs, optimized for professional fabric printing",
      "url": "https://www.patternripple.com/png2svg.html",
      "applicationCategory": "DesignApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Person",
        "name": "Nick Panek"
      }
    }
    </script>

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'accent': '#5399B5',
                        'ancient-dark': '#111111',
                        'ancient-darker': '#0a0a0a',
                        'parchment': '#f4ead5'
                    },
                    fontFamily: {
                        'serif': ['Georgia', 'Garamond', 'serif'],
                        'ancient': ['Cinzel', 'Georgia', 'serif']
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Cinzel for elegant aesthetic -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Cinzel', Georgia, serif;
        }

        .ancient-border {
            border-image: linear-gradient(135deg, #5399B5, #2d5a6e) 1;
        }

        .progress-bar {
            transition: width 0.3s ease-in-out;
        }

        .accent-glow {
            box-shadow: 0 0 20px rgba(83, 153, 181, 0.3);
        }

        .upload-zone {
            transition: all 0.3s ease;
        }

        .upload-zone:hover {
            border-color: #5399B5;
            background-color: rgba(83, 153, 181, 0.05);
        }

        .upload-zone.dragover {
            border-color: #5399B5;
            background-color: rgba(83, 153, 181, 0.1);
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-ancient-dark text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-ancient-darker border-b border-gray-700 py-8">
        <div class="max-w-4xl mx-auto px-4">
            <h1 class="text-4xl md:text-5xl font-light text-center mb-3">
                <span class="text-accent">PNG</span>2<span class="text-accent">SVG</span>
            </h1>
            <p class="text-center text-gray-400 text-sm md:text-base">
                Vectorize Your Fabric Designs for Professional Printing
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-12">

        <!-- Instructions Panel -->
        <div class="bg-gray-900 rounded-lg p-6 mb-8 border border-gray-700">
            <h2 class="text-xl font-semibold mb-3 text-accent">How It Works</h2>
            <ol class="text-gray-300 space-y-2 text-sm">
                <li class="flex items-start">
                    <span class="text-accent font-bold mr-2">1.</span>
                    <span>Upload your 1024×1024px PNG design</span>
                </li>
                <li class="flex items-start">
                    <span class="text-accent font-bold mr-2">2.</span>
                    <span>Preview your design and optionally rename the output file</span>
                </li>
                <li class="flex items-start">
                    <span class="text-accent font-bold mr-2">3.</span>
                    <span>Click "Convert to SVG" to vectorize using optimized settings for artistic patterns</span>
                </li>
                <li class="flex items-start">
                    <span class="text-accent font-bold mr-2">4.</span>
                    <span>Download your SVG file for professional fabric printing</span>
                </li>
            </ol>
            <p class="text-xs text-gray-500 mt-4 italic">
                ✦ All processing happens in your browser. No uploads to servers. Complete privacy.
            </p>
        </div>

        <!-- Upload Section -->
        <div class="mb-8">
            <label for="fileInput" class="block text-sm font-medium text-gray-300 mb-2">
                Select PNG Image
            </label>
            <div id="dropZone" class="upload-zone border-2 border-dashed border-gray-600 rounded-lg p-12 text-center cursor-pointer">
                <input type="file" id="fileInput" accept="image/png" class="hidden">
                <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <p class="text-gray-400 mb-2">Click to upload or drag and drop</p>
                <p class="text-xs text-gray-500">PNG files only • Recommended: 1024×1024px</p>
            </div>
        </div>

        <!-- Preview & Controls Section -->
        <div id="previewSection" class="hidden">
            <!-- Image Preview -->
            <div class="bg-gray-900 rounded-lg p-6 mb-6 border border-gray-700">
                <h3 class="text-lg font-semibold mb-4 text-accent">Preview</h3>
                <div class="flex justify-center mb-4">
                    <canvas id="previewCanvas" class="max-w-full h-auto rounded border-2 border-gray-600"></canvas>
                </div>
                <p id="imageInfo" class="text-sm text-gray-400 text-center"></p>
            </div>

            <!-- File Naming -->
            <div class="bg-gray-900 rounded-lg p-6 mb-6 border border-gray-700">
                <label for="fileName" class="block text-sm font-medium text-gray-300 mb-2">
                    Output Filename
                </label>
                <div class="flex items-center gap-2">
                    <input
                        type="text"
                        id="fileName"
                        class="flex-1 bg-gray-800 border border-gray-600 rounded px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-accent"
                        placeholder="my-fabric-design"
                    >
                    <span class="text-gray-400">.svg</span>
                </div>
                <p class="text-xs text-gray-500 mt-2">Enter a custom name for your SVG file</p>
            </div>

            <!-- Conversion Controls -->
            <div class="bg-gray-900 rounded-lg p-6 mb-6 border border-gray-700">
                <button
                    id="convertBtn"
                    class="w-full bg-accent hover:bg-[#4588a4] text-white font-semibold py-3 px-6 rounded transition-colors duration-200"
                >
                    Convert to SVG
                </button>

                <!-- Progress Bar -->
                <div id="progressContainer" class="hidden mt-4">
                    <div class="flex justify-between text-sm text-gray-400 mb-2">
                        <span id="progressText">Processing...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2 overflow-hidden">
                        <div id="progressBar" class="progress-bar bg-accent h-full rounded-full" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Download Button -->
                <button
                    id="downloadBtn"
                    class="hidden w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded transition-colors duration-200 mt-4"
                >
                    Download SVG
                </button>
            </div>

            <!-- SVG Preview -->
            <div id="svgPreviewSection" class="hidden bg-gray-900 rounded-lg p-6 border border-gray-700">
                <h3 class="text-lg font-semibold mb-4 text-accent">SVG Output Preview</h3>
                <div class="bg-white rounded p-4 flex justify-center items-center min-h-[300px]">
                    <div id="svgPreview" class="max-w-full max-h-[500px]"></div>
                </div>
            </div>
        </div>

        <!-- Hidden Canvas for Processing -->
        <canvas id="processingCanvas" class="hidden"></canvas>

    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-700 mt-16 py-8">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <p class="text-gray-500 text-sm mb-2">
                Part of the <a href="/" class="text-accent hover:underline">PatternRipple</a> suite of design tools
            </p>
            <p class="text-gray-600 text-xs">
                Built by <a href="https://nickpanek.com" class="text-accent hover:underline">Nick Panek</a> for fabric artists
            </p>
        </div>
    </footer>

    <!-- VTracer WASM Library -->
    <script type="module">
        // Import vectortracer from CDN
        import init, { BinaryImageConverter } from 'https://cdn.jsdelivr.net/npm/vectortracer@0.5.1/vectortracer.js';

        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // Initialize WASM
        let wasmInitialized = false;

        async function initializeWasm() {
            if (!wasmInitialized) {
                try {
                    await init();
                    wasmInitialized = true;
                    console.log('VTracer WASM initialized');
                } catch (err) {
                    console.error('Failed to initialize WASM:', err);
                    alert('Failed to load vector conversion engine. Please refresh the page.');
                }
            }
        }

        function initializeApp() {
            // DOM Elements
            const fileInput = document.getElementById('fileInput');
            const dropZone = document.getElementById('dropZone');
            const previewSection = document.getElementById('previewSection');
            const previewCanvas = document.getElementById('previewCanvas');
            const processingCanvas = document.getElementById('processingCanvas');
            const imageInfo = document.getElementById('imageInfo');
            const fileName = document.getElementById('fileName');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const progressPercent = document.getElementById('progressPercent');
            const svgPreviewSection = document.getElementById('svgPreviewSection');
            const svgPreview = document.getElementById('svgPreview');

            let currentImage = null;
            let currentImageData = null;
            let currentSvgString = null;

            // Initialize WASM when page loads
            initializeWasm();

            // File Upload Handlers
            dropZone.addEventListener('click', () => {
                console.log('Drop zone clicked');
                fileInput.click();
            });

            fileInput.addEventListener('change', handleFileSelect);

            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            function handleFileSelect(e) {
                const file = e.target.files[0];
                if (file) {
                    handleFile(file);
                }
            }

            function handleFile(file) {
                if (!file.type.startsWith('image/png')) {
                    alert('Please upload a PNG file.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        currentImage = img;
                        displayPreview(img);

                        // Set default filename from original file
                        const baseName = file.name.replace(/\.[^/.]+$/, '');
                        fileName.value = baseName + '-vector';
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            function displayPreview(img) {
                // Show preview section
                previewSection.classList.remove('hidden');

                // Set canvas size
                const maxSize = 512;
                let width = img.width;
                let height = img.height;

                if (width > maxSize || height > maxSize) {
                    const scale = Math.min(maxSize / width, maxSize / height);
                    width *= scale;
                    height *= scale;
                }

                previewCanvas.width = width;
                previewCanvas.height = height;

                // Draw preview
                const ctx = previewCanvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);

                // Update info
                imageInfo.textContent = `${img.width} × ${img.height}px`;

                // Reset conversion state
                downloadBtn.classList.add('hidden');
                svgPreviewSection.classList.add('hidden');
                currentSvgString = null;

                // Scroll to preview
                previewSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // Conversion Handler
            convertBtn.addEventListener('click', async () => {
                if (!currentImage) return;

                try {
                    // Ensure WASM is initialized
                    if (!wasmInitialized) {
                        await initializeWasm();
                    }

                    // Disable button
                    convertBtn.disabled = true;
                    convertBtn.textContent = 'Converting...';

                    // Show progress
                    progressContainer.classList.remove('hidden');
                    updateProgress(0, 'Preparing image data...');

                    // Get image data
                    const imageData = await getImageData(currentImage);
                    currentImageData = imageData;

                    updateProgress(10, 'Initializing vectorization...');

                    // Configure vtracer options for artistic patterns
                    const options = {
                        color_mode: 'color',
                        mode: 'spline',  // Best for smooth artistic curves
                        filter_speckle: 4,  // Remove small noise
                        color_precision: 6,  // Good color accuracy
                        layer_difference: 16,  // Moderate color layer separation
                        corner_threshold: 60,  // Smoother corners
                        length_threshold: 4.0,  // Balance detail vs simplification
                        splice_threshold: 45,  // Smooth curve splicing
                        path_precision: 8  // High path precision
                    };

                    updateProgress(20, 'Creating converter...');

                    // Create converter
                    const converter = new BinaryImageConverter(
                        new Uint8ClampedArray(imageData.data),
                        imageData.width,
                        imageData.height,
                        options
                    );

                    updateProgress(30, 'Processing vectors...');

                    // Process with progress updates
                    await processWithProgress(converter);

                    updateProgress(90, 'Generating SVG...');

                    // Get SVG result
                    const svgString = converter.get_svg();
                    currentSvgString = svgString;

                    updateProgress(100, 'Complete!');

                    // Show download button
                    downloadBtn.classList.remove('hidden');

                    // Show SVG preview
                    displaySvgPreview(svgString);

                    // Reset button
                    convertBtn.disabled = false;
                    convertBtn.textContent = 'Convert to SVG';

                    // Scroll to download
                    downloadBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });

                } catch (error) {
                    console.error('Conversion error:', error);
                    alert('Conversion failed: ' + error.message);

                    // Reset UI
                    convertBtn.disabled = false;
                    convertBtn.textContent = 'Convert to SVG';
                    progressContainer.classList.add('hidden');
                }
            });

            async function processWithProgress(converter) {
                return new Promise((resolve) => {
                    let progress = 30;
                    const step = () => {
                        const done = converter.tick();

                        progress = Math.min(85, progress + 1);
                        updateProgress(progress, 'Processing vectors...');

                        if (done) {
                            resolve();
                        } else {
                            setTimeout(step, 0);
                        }
                    };
                    step();
                });
            }

            function getImageData(img) {
                return new Promise((resolve) => {
                    processingCanvas.width = img.width;
                    processingCanvas.height = img.height;

                    const ctx = processingCanvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);

                    const imageData = ctx.getImageData(0, 0, img.width, img.height);
                    resolve(imageData);
                });
            }

            function updateProgress(percent, text) {
                progressBar.style.width = percent + '%';
                progressPercent.textContent = Math.round(percent) + '%';
                progressText.textContent = text;
            }

            function displaySvgPreview(svgString) {
                svgPreview.innerHTML = svgString;
                svgPreviewSection.classList.remove('hidden');

                // Scale SVG to fit preview
                const svgElement = svgPreview.querySelector('svg');
                if (svgElement) {
                    svgElement.style.maxWidth = '100%';
                    svgElement.style.height = 'auto';
                }
            }

            // Download Handler
            downloadBtn.addEventListener('click', () => {
                if (!currentSvgString) return;

                const filename = (fileName.value.trim() || 'pattern-vector') + '.svg';

                const blob = new Blob([currentSvgString], { type: 'image/svg+xml' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                URL.revokeObjectURL(url);

                // Visual feedback
                const originalText = downloadBtn.textContent;
                downloadBtn.textContent = '✓ Downloaded!';
                setTimeout(() => {
                    downloadBtn.textContent = originalText;
                }, 2000);
            });
        }
    </script>
</body>
</html>
